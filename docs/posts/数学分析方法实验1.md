---
title: 数学分析方法实验1
date: 2023-04-21 13:58:48
tags:
- 实验报告
- 大数据分析
Categories:
- 大数据分析方法
- 实验报告
---

# 实验一 多项式曲线拟合

## 一、实验目的 

熟悉和掌握线性回归，并且利用 Python 实现多项式的曲线拟合。 

## 二、线性回归基本原理

线性回归主要分一元线性回归和多元线性回归。一元线性回归只包括一个自 变量和一个因变量，且二者的关系可用一条直线近似表示。如果回归分析中包括 两个或两个以上的自变量，且因变量和自变量之间是线性关系，则称为多元线性 回归分析。 

## 三、实验过程与内容

 第一步：生成数据

生成𝑁个数据𝑋 = ( 𝑥 1 , . . . . . , 𝑥 𝑁 ) 𝑇 , 𝑋均匀分布于区间[0,1]:

`𝑋 = 𝑛𝑝 . 𝑙𝑖𝑛𝑠𝑝𝑎𝑐𝑒 ( 0 , 1 , 𝑁 ) `，

𝑋对应的$𝑇=( 𝑡_1 ,. . . . . , 𝑡_𝑁 )$ ，其中，$𝑡𝑖 = sin ( 2𝜋𝑥 ) + 𝑛𝑝. 𝑟𝑎𝑛𝑑𝑜𝑚. 𝑛𝑜𝑟𝑚𝑎𝑙( 𝑠𝑐𝑎𝑙𝑒 = 0.15 , 𝑠𝑖𝑧𝑒 = 𝑁 ) , 𝑖 = 1 , … , 𝑁.(𝑥𝑖, 𝑡𝑖 )$ ，其中 $𝑖=1 , … , 𝑁$，即为生成的样本集。假设样本集包含 10 个点，则𝑁 =10。

第二步：拟合生成数据 使用多项式函数来拟合生成的数据。多项式定义如下：
$$
𝑦( 𝑥 , 𝒘 ) 𝑤_0 + 𝑤_1 𝑥 + 𝑤_2 𝑥_2 + . . . +𝑤_𝑀 𝑥^𝑀 =  ∑_{𝑗 = 0}^𝑀 𝑤_𝑗 𝑥_𝑗 .
$$
其中，𝑀 是多项式的阶数,$𝑥_𝑗$ 表示 𝑥 的 𝑗 次幂。多项式系数 $𝑤_0 , … , 𝑤$ 𝑀 记作向量 𝒘 。 多项式系数的求解可以通过最小化误差函数来实现，误差函数衡量了每个数 据点 𝑥𝑖 的预测值 𝑦( 𝑥𝑖 , 𝒘 ) 与目标值 $𝑡_𝑖$ 之间的差异。最常用的误差函数为均方误差函数，定义如下：
$$
𝐸 ( 𝒘 ) = \frac{1}{2}∑_{𝑖 = 1}^𝑁 {𝑦( 𝑥_𝑖 , 𝒘 ) − 𝑡_𝑖 }.
$$
因为误差函数是多项式系数 𝒘 的二次函数，所以存在唯一最小值，且在导数为零处取得。

## 四、 实验过程

### 核心代码

```python
#!/usr/bin/env python
# -*- encoding: utf-8 -*-
'''
@Time    :   2023/04/21 15:01:31
@Author  :   蔡晋宇
@Email   :   cai@caijy.life
@Blog    :   https://ccccai.cc
@Copyright : 侵权必究
'''

# here put the import lib

import numpy as np
import matplotlib.pyplot as plt

# 生成数据
N = 10
X = np.linspace(0, 1, N)
T = np.sin(2 * np.pi * X) + np.random.normal(scale=0.15, size=N)

# 画出原始数据
plt.scatter(X, T, label='Data')

# 多项式拟合
M_list = [0, 1, 3, 5, 7, 9]
for M in M_list:
    X_poly = np.vander(X, M + 1, increasing=True)
    w = np.linalg.inv(X_poly.T @ X_poly) @ X_poly.T @ T

    # 画出拟合结果
    X_plot = np.linspace(0, 1, 100)
    X_plot_poly = np.vander(X_plot, M + 1, increasing=True)
    T_plot = X_plot_poly @ w

    plt.plot(X_plot, T_plot, label=f'M={M}')

plt.legend()
plt.show()

```

### 实验结果

![Figure_1](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202304211510820.png)

### 结果分析

从上面的图像可以看出，不同阶数多项式对数据的拟合效果不同。下面对每个多项式阶数的拟合效果进行分析：

1. M=0：当多项式阶数为0时，拟合函数为常数。从图中可以看出，常数函数不能很好地拟合数据，因为数据具有明显的周期性，而常数函数无法表示周期性函数。因此，当多项式阶数为0时，拟合效果较差。
2. M=1：当多项式阶数为1时，拟合函数为线性函数。线性函数能够比常数函数更好地拟合数据，因为线性函数可以表示数据的整体趋势。从图中可以看出，线性函数能够比常数函数更好地拟合数据，但仍然不能很好地表示数据的周期性。
3. M=3：当多项式阶数为3时，拟合函数为三次函数。三次函数能够比线性函数更好地拟合数据，因为三次函数可以表示数据的局部变化。从图中可以看出，三次函数能够比线性函数更好地拟合数据，并且能够表示数据的周期性。
4. M=5：当多项式阶数为5时，拟合函数为五次函数。五次函数能够比三次函数更好地拟合数据，因为五次函数可以更精细地表示数据的局部变化。从图中可以看出，五次函数能够比三次函数更好地拟合数据，并且能够更精细地表示数据的周期性。
5. M=7：当多项式阶数为7时，拟合函数为七次函数。七次函数能够比五次函数更好地拟合数据，因为七次函数可以更精细地表示数据的局部变化。从图中可以看出，七次函数能够比五次函数更好地拟合数据，并且能够更精细地表示数据的周期性。
6. M=9：当多项式阶数为9时，拟合函数为九次函数。九次函数能够比七次函数更好地拟合数据，因为九次函数可以更精细地表示数据的局部变化。从图中可以看出，九次函数能够比七次函数更好地拟合数据，并且能够更精细地表示数据的周期性。但是，九次函数在数据的两端出现了明显的过拟合现象，即对训练数据拟合得太好，无法很好地泛化到测试数据。

综上所述，通过对不同阶数多项式的拟合效果进行分析，我们可以得出结论：选择适合数据特征的多项式阶数可以更好地拟合数据。过低的多项式阶数无法很好地表示数据的特征，而过高的多项式阶数容易出现过拟合现象，从而降低了模型的泛化性能。
