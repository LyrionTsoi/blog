---
title: 计算机网络原理课程设计
date: 2023-04-23 21:37:59
tags:
- 报告
categories:
- 大学
- 课程设计
---

### 3.3动态路由协议的设计与实现

RIP（Routing Information Protocol）是一种基于距离向量算法的内部路由协议，用于在局域网中自动选择最优路径，常用于小型网络中。

在一个比较大的网络中，为了更好地适应复杂的网络拓扑和提高路由协议的性能，应该选择具有以下特点的内部路由协议：

1. 支持VLSM（可变长度子网掩码）：VLSM可以更好地利用IP地址资源，适应复杂的网络拓扑结构。
2. 支持快速收敛：在网络故障时，路由协议需要快速适应网络变化，恢复网络连接，避免数据包丢失和延迟。
3. 支持路由汇总：通过路由汇总可以减小路由表大小，提高路由协议的性能。
4. 支持路由器认证：路由器认证可以提高网络安全性，防止非法路由器进入网络。

RIPv1和RIPv2的区别如下：

1. 子网掩码支持：RIPv1在思科系统中默认使用类别掩码，不支持VLSM。而RIPv2可以支持VLSM。
2. 路由器认证：RIPv1在思科系统中不支持路由器认证。而RIPv2可以使用MD5认证来提高网络安全性。
3. 路由更新方式：RIPv1在思科系统中使用广播方式发送路由更新信息。而RIPv2可以使用广播、多播和单播方式发送路由更新信息。
4. 路由表大小：RIPv1在思科系统中使用类别路由，因此路由表大小比RIPv2大。而RIPv2可以更有效地使用网络地址，因此可以减小路由表大小。
5. 支持的路由器数量：RIPv1在思科系统中最多支持15个跃点，而RIPv2最多支持255个跃点。

在我们的实验中采取的是RIPv2版本，因为我们的拓扑结构会比较大，所以的在较小的跳数的情况下，有可能会超过的15跳，导致表现为不可达的状态的错误。

**基本配置**

```c++
router rip
version 2
```

然后在依次对拓扑网络中的路由器进行RIP配置，下面以中心图书馆配置举例

![中心图书馆拓扑图](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202304271439394.png)

```c++
network 10.10.0.0
network 17.10.0.0
```

![中心宿舍RIP](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202304271454443.png)

```c++
L-Router#show ip route rip
     10.0.0.0/8 is variably subnetted, 18 subnets, 3 masks
R       10.10.14.0/24 [120/2] via 10.10.11.2, 00:00:23, Serial0/0/1
R       10.10.15.0/24 [120/1] via 10.10.11.2, 00:00:23, Serial0/0/1
R       10.10.16.0/24 [120/1] via 10.10.11.2, 00:00:23, Serial0/0/1
R       10.10.24.0/24 [120/3] via 10.10.13.1, 00:00:07, Serial0/0/0
R       10.10.25.0/24 [120/4] via 10.10.13.1, 00:00:07, Serial0/0/0
R       10.10.26.0/24 [120/3] via 10.10.13.1, 00:00:07, Serial0/0/0
     17.0.0.0/8 is variably subnetted, 10 subnets, 2 masks
R       17.10.11.0/24 [120/2] via 17.10.10.1, 00:00:22, Serial0/1/0
R       17.30.12.0/24 [120/3] via 10.10.13.1, 00:00:07, Serial0/0/0
R       17.30.13.0/24 [120/3] via 10.10.13.1, 00:00:07, Serial0/0/0
     172.16.0.0/16 is variably subnetted, 12 subnets, 2 masks
R       172.16.254.0/28 [120/4] via 10.10.13.1, 00:00:07, Serial0/0/0
R       172.16.254.16/28 [120/4] via 10.10.13.1, 00:00:07, Serial0/0/0
R       172.16.254.32/28 [120/4] via 10.10.13.1, 00:00:07, Serial0/0/0
R       172.16.254.64/28 [120/4] via 10.10.13.1, 00:00:07, Serial0/0/0
R       172.16.254.80/28 [120/4] via 10.10.13.1, 00:00:07, Serial0/0/0
R       172.16.254.96/28 [120/4] via 10.10.13.1, 00:00:07, Serial0/0/0
     192.168.248.0/24 is variably subnetted, 7 subnets, 2 masks
R       192.168.248.0/27 [120/2] via 17.10.10.1, 00:00:22, Serial0/1/0
R       192.168.248.32/27 [120/2] via 17.10.10.1, 00:00:22, Serial0/1/0
R       192.168.248.64/27 [120/2] via 17.10.10.1, 00:00:22, Serial0/1/0
R       192.168.248.128/27 [120/3] via 17.10.10.1, 00:00:22, Serial0/1/0
R       192.168.248.160/27 [120/3] via 17.10.10.1, 00:00:22, Serial0/1/0
R       192.168.248.192/27 [120/3] via 17.10.10.1, 00:00:22, Serial0/1/0
     192.168.249.0/27 is subnetted, 3 subnets
R       192.168.249.0 [120/2] via 17.10.10.1, 00:00:22, Serial0/1/0
R       192.168.249.32 [120/2] via 17.10.10.1, 00:00:22, Serial0/1/0
R       192.168.249.64 [120/2] via 17.10.10.1, 00:00:22, Serial0/1/0
     192.168.250.0/24 is variably subnetted, 4 subnets, 2 masks
R       192.168.250.0/26 [120/2] via 10.10.11.2, 00:00:23, Serial0/0/1
R       192.168.250.64/26 [120/2] via 10.10.11.2, 00:00:23, Serial0/0/1
R       192.168.250.128/26 [120/2] via 10.10.11.2, 00:00:23, Serial0/0/1
     192.168.255.0/24 is variably subnetted, 2 subnets, 2 masks
```

其他路由器同理设置，所以不再一一进行展示

**OSPF原理**

OSPF是一种链路状态协议，这意味着每个路由器都会向其相邻的路由器发送链路状态信息(LSA)，描述它所连接的网络拓扑。OSPF路由器使用这些LSA来构建一个拓扑数据库(Topology Database)，该数据库存储网络中所有路由器和连接的链路信息。使用这些信息，每个路由器都可以计算到达目标网络的最短路径。

OSPF将网络拓扑分解为一个或多个区域(Area)，每个区域都有一个唯一的标识符。路由器只会在同一区域内交换LSA信息，并且只有区域边界路由器(ABR)才会将LSA信息转发到其他区域。

**OSPF基本配置**

下面是一个基本的OSPF配置示例，假设我们有两个路由器R1和R2，它们都连接到网络10.0.0.0/24。

步骤1：启用OSPF

首先，我们需要在路由器上启用OSPF进程，并指定OSPF进程ID。

```c++
R1(config)# router ospf 1
R2(config)# router ospf 1
```

步骤2：为每个接口分配OSPF区域

接下来，我们需要为每个连接到网络的接口分配一个OSPF区域。

```c++
R1(config-router)# network 10.0.0.0 0.0.0.255 area 0
R2(config-router)# network 10.0.0.0 0.0.0.255 area 0
```

命令 "network 10.0.0.0 0.0.0.255 area 0" 中的 "0.0.0.255" 是用来指定 OSPF 网络地址的掩码。

具体来说，在这个命令中，"10.0.0.0" 是 OSPF 网络地址，"0.0.0.255" 则是掩码。掩码用于指示哪些位是网络地址位，哪些位是主机地址位。在这个例子中，掩码 "0.0.0.255" 意味着，前三个字节是网络地址，最后一个字节是主机地址。

这个命令的作用是将指定的网络地址添加到 OSPF 的路由表中，并将其分配到指定的 OSPF 区域（在这个例子中是区域 0）。这个命令还会使路由器自动检测该网络的连接类型，如点对点连接或广播连接，并相应地配置 OSPF。

值得注意的是，这个命令中的掩码是用于指定网络地址的掩码，而不是用于指定子网掩码的掩码。如果要指定子网掩码，可以使用命令 "ip ospf network" 来指定网络类型。

在这个示例中，我们将接口所连接的网络定义为10.0.0.0/24，并将其分配到OSPF区域0中。下面同样的以东校宿舍配置为例：

```c++
#配置动态路由协议OSPF v2
router ospf 10

router-id 3.3.2.1

network 172.16.254.128 0.0.0.127 area 2
network 10.10.21.254 0.0.0.255 area 2
network 10.10.27.1 0.0.0.255 area 2
```

查看ospf：

```c++
10.0.0.0/8 is variably subnetted, 19 subnets, 3 masks
O IA    10.10.10.0 [110/129] via 10.10.21.1, 00:12:09, Serial0/0/0
O IA    10.10.11.0 [110/192] via 10.10.21.1, 00:12:09, Serial0/0/0
O IA    10.10.12.0 [110/192] via 10.10.21.1, 00:12:09, Serial0/0/0
O IA    10.10.13.0 [110/192] via 10.10.21.1, 00:12:09, Serial0/0/0
O       10.10.20.0 [110/128] via 10.10.23.1, 00:12:39, Serial0/1/0
                   [110/128] via 10.10.21.1, 00:12:39, Serial0/0/0
O       10.10.22.0 [110/128] via 10.10.27.2, 00:12:39, Serial0/0/1
                   [110/128] via 10.10.21.1, 00:12:39, Serial0/0/0
O IA    10.140.128.0 [110/192] via 10.10.21.1, 00:12:39, Serial0/0/0
     17.0.0.0/24 is subnetted, 9 subnets
O IA    17.10.10.0 [110/256] via 10.10.21.1, 00:12:09, Serial0/0/0
     172.16.0.0/16 is variably subnetted, 17 subnets, 4 masks
O       172.16.255.0 [110/65] via 10.10.27.2, 00:12:39, Serial0/0/1
O       172.16.255.32 [110/65] via 10.10.27.2, 00:12:39, Serial0/0/1
O       172.16.255.64 [110/65] via 10.10.27.2, 00:12:39, Serial0/0/1
O IA 192.16.2.0 [110/1064] via 10.10.21.1, 00:12:39, Serial0/0/0
     192.168.252.0/25 is subnetted, 1 subnets
O IA    192.168.252.0 [110/130] via 10.10.21.1, 00:12:09, Serial0/0/0
     192.168.253.0/25 is subnetted, 2 subnets
O IA    192.168.253.0 [110/130] via 10.10.21.1, 00:12:09, Serial0/0/0
O IA    192.168.253.128 [110/130] via 10.10.21.1, 00:12:09, Serial0/0/0
O IA 192.168.254.0 [110/193] via 10.10.21.1, 00:12:09, Serial0/0/0
O IA 192.168.255.0 [110/193] via 10.10.21.1, 00:12:09, Serial0/0/0
O IA 209.100.10.0 [110/192] via 10.10.21.1, 00:12:39, Serial0/0/0
O IA 209.100.20.0 [110/128] via 10.10.21.1, 00:12:39, Serial0/0/0
O IA 209.168.10.0 [110/128] via 10.10.21.1, 00:12:39, Serial0/0/0
```



### 3.4访问控制列表的设计与实现

**ACL的简介与配置时候的注意事项**

ACL（Access Control List，访问控制列表）是一种网络安全技术，用于限制网络流量，控制哪些主机可以访问网络中的哪些资源。ACL通常用于路由器、交换机、防火墙等网络设备中，可以基于源IP地址、目的IP地址、协议类型、端口号等条件进行流量过滤和控制。

ACL可以分为标准ACL和扩展ACL两种类型：

1. 标准ACL：基于源IP地址进行过滤和控制，只能匹配源IP地址，不能匹配其他条件。因此，标准ACL适用于简单的网络环境，例如限制某个特定的主机或者子网访问网络中的资源。

2. 扩展ACL：基于源IP地址、目的IP地址、协议类型、端口号等条件进行过滤和控制，可以更加精细地控制网络流量。因此，扩展ACL适用于复杂的网络环境，例如限制某个特定的主机或者子网访问某个特定的服务。

在配置ACL时，需要注意以下几点：

1. ACL应该根据实际情况进行调整，避免误限制合法流量。

2. ACL的顺序很重要，因为ACL是按照顺序依次匹配的。

3. ACL的匹配顺序是从上到下，一旦匹配成功就会执行相应的动作，因此要将最常用的ACL条目放在前面。

4. ACL可以应用到接口的入站流量或出站流量中，应根据网络需求进行选择。

总的来说，ACL是一种非常重要的网络安全技术，可以帮助网络管理员控制网络流量，保护网络安全。

**ACL使用介绍**

使用可以标准ACL（Standard Access Control List）和扩展ACL（Extended Access Control List）来限制网络流量，保障网络安全。下面是配置ACL的步骤：

1. 进入特权模式：在用户模式下，输入enable命令，进入特权模式。

2. 进入全局配置模式：在特权模式下，输入configure terminal命令，进入全局配置模式。

3. 创建ACL：在全局配置模式下，使用access-list命令创建ACL。例如，创建一个扩展ACL，允许源IP为192.168.1.0/24的主机访问目的IP为10.0.0.0/24的主机，可以输入以下命令：

```c++
access-list 101 permit ip 192.168.1.0 0.0.0.255 10.0.0.0 0.0.0.255
```

其中，101为ACL的编号，ip为ACL的类型，192.168.1.0 0.0.0.255为源IP地址和掩码，10.0.0.0 0.0.0.255为目的IP地址和掩码。

上面是`permit` 反之 `deny`也是对应使用的

4. 应用ACL：在全局配置模式下，使用interface命令进入接口配置模式，并使用ip access-group命令将ACL应用到接口上。例如，将ACL 101应用到接口GigabitEthernet0/1上，可以输入以下命令：

```c++
interface GigabitEthernet0/1
ip access-group 101 in
```

其中，in表示应用ACL到入站流量，out表示应用ACL到出站流量。

5. 保存配置：在全局配置模式下，使用exit命令返回特权模式，使用write命令保存配置。

需要注意的是，ACL应该根据实际情况进行调整，避免误限制合法流量，同时也要注意ACL的顺序，因为ACL是按照顺序依次匹配的。

**实验配置**

我们对校园的设计的是

1. 图书馆中配置有服务器L-Server，为校内人员提供服务，不允许校外人员访问服务器的ftp服务【使用扩展ACL限制对目的主机（服务器）的访问】

   设置在Edge-Router外网端口的入站方向

2. 严格限制校内主机对外部网络服务器R-Server的访问，仅允许校内办公区主机自由登录R-Server；允许校内其他主机与外部网络的主机通信，但不允许以任何流量类型访问R-Server【使用扩展ACL严格限制校内主机对R-Server的访问】
   设置在Edge-Router外网端口的出站方向

```c++
#配置编号为101的扩展ACL以限制外部网络对图书馆服务器的访问
access-list 101 deny tcp any host 192.168.254.254 eq ftp
access-list 101 deny tcp any host 192.168.254.254 eq 20
access-list 101 permit ip any any
 
int s0/1/0
ip access-group 101 in

#配置编号为102的扩展ACL以限制中心校区内部非办公区主机对Google服务器（位于远程网络）的访问
access-list 102 permit ip 192.168.252.0 0.0.1.255 host 198.16.3.254
access-list 102 deny ip 192.168.248.0 0.0.7.255 host 198.16.3.254
access-list 102 permit ip any any

int s0/0/0
ip access-group 102 in

#配置编号为103的扩展ACL以限制东部校区内部主机对Google服务器（位于远程网络）的访问
access-list 103 deny ip 172.16.254.0 0.0.1.255 host 198.16.3.254
access-list 103 permit ip any any

int s0/0/1
ip access-group 103 in

#配置PAT以将校内地址转换为公网地址
ip nat pool EdgePAT 10.140.128.1 10.140.159.254 netmask 255.255.224.0
access-list 10 permit 192.168.248.0 0.0.7.255
access-list 10 permit 172.16.254.0 0.0.1.255
ip nat inside source list 10 pool EdgePAT overload
int s0/0/0
ip nat inside
int s0/0/1
ip nat inside
int s0/1/0
ip nat outside
```

**ping测试，测试是否使用了ACL阻止了两端的连通性**

![博知电脑ping测试](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202304271534946.png)

从上面可以证得从校内电脑无法访问校外服务器

### 3.5 DHCP协议的设计与实现

**DHCP介绍及基本原理介绍**

DHCP（Dynamic Host Configuration Protocol，动态主机配置协议）是一种网络协议，用于为网络中的主机动态分配IP地址、子网掩码、默认网关、DNS服务器等网络参数。

DHCP的工作原理可以分为以下几个步骤：

1. DHCP发现：当客户端主机加入网络时，它会广播DHCP发现请求，寻找可用的DHCP服务器。

2. DHCP提供：DHCP服务器接收到DHCP发现请求后，会向客户端发送DHCP提供，包括可用的IP地址、子网掩码、默认网关、DNS服务器等信息。

3. DHCP请求：客户端接收到DHCP提供后，会向DHCP服务器发送DHCP请求，请求特定的IP地址和其他网络参数。

4. DHCP确认：DHCP服务器接收到DHCP请求后，会向客户端发送DHCP确认，确认客户端分配的IP地址和其他网络参数。

5. DHCP租约：客户端分配的IP地址和其他网络参数具有一定的有效期，在租约到期之前，客户端可以继续使用这些参数。如果租约到期，客户端需要再次向DHCP服务器请求新的租约。

DHCP有以下几个优点：

1. 方便管理：DHCP可以自动分配IP地址和其他网络参数，减轻了网络管理员的工作量。

2. 灵活性：DHCP可以为不同的客户端分配不同的IP地址和其他网络参数，提高了网络的灵活性。

3. 节省IP地址：DHCP可以动态分配IP地址，避免了IP地址浪费的问题。

4. 减少错误：DHCP可以减少手动配置IP地址和其他网络参数的错误，提高了网络的可靠性。

总的来说，DHCP是一种非常重要的网络协议，可以帮助网络管理员方便地管理网络中的主机IP地址和其他网络参数，提高网络的可靠性和灵活性。

**基本配置**

在思科系统中，进行基本的DHCP配置可以分为以下几个步骤：

1. 进入特权模式：在用户模式下，输入enable命令，进入特权模式。

2. 进入全局配置模式：在特权模式下，输入configure terminal命令，进入全局配置模式。

3. 配置DHCP池：使用ip dhcp pool命令创建DHCP池，并配置分配的IP地址范围、默认网关、DNS服务器、租约时间等。例如，创建名为"dhcp-pool1"的DHCP池，分配192.168.1.10至192.168.1.30的IP地址，设置192.168.1.1为默认网关，设置8.8.8.8和8.8.4.4为DNS服务器，设置租约时间为1天可以输入以下命令：

```c++
ip dhcp pool dhcp-pool1
network 192.168.1.0 255.255.255.0
default-router 192.168.1.1
dns-server 8.8.8.8 8.8.4.4
lease 1
```

4. 配置DHCP服务：使用interface命令进入接口配置模式，并启用DHCP服务。例如，将GigabitEthernet0/0接口启用DHCP服务可以输入以下命令：

```c++
interface GigabitEthernet0/0
ip address dhcp
```

其中，ip address dhcp表示启用DHCP服务。

5. 保存配置：在全局配置模式下，使用end命令返回特权模式，并使用write命令将配置保存到设备的非易失性存储器（NVRAM）中。例如，输入以下命令保存配置：

```
end
write
```

当然也是可以通过图形界面配置的。下面以中心校区的实验楼为例：

1. 实验楼人员变动较大，所以将ExE区域的主机全部配置为DHCP模式，将ExE-Router配置为DHCP服务器（包含三个地址池，即为现有三个网段）
2. 三个网段的DHCP地址池名称分别为LanPool-1、LanPool-2、LanPool-3，分别对应原有静态IP时配置的三个子网段；排除前两个可用IP地址和最后一个可用IP地址
   即LanPool-1：172.16.255.3~172.16.255.29，默认网关172.16.255.1
     LanPool-2：172.16.255.35~172.16.255.61，默认网关172.16.255.33
     LanPool-3：172.16.255.67~172.16.255.93，默认网关172.16.255.65



```c++
#配置DHCP服务器

ip dhcp excluded-address 172.16.255.1 172.16.255.2
ip dhcp excluded-address 172.16.255.30
ip dhcp pool LanPool-1
network 172.16.255.0 255.255.255.224
default-router 172.16.255.1

ip dhcp excluded-address 172.16.255.33 172.16.255.34
ip dhcp excluded-address 172.16.255.62
ip dhcp pool LanPool-2
network 172.16.255.32 255.255.255.224
default-router 172.16.255.33

ip dhcp excluded-address 172.16.255.65 172.16.255.66
ip dhcp excluded-address 172.16.255.94
ip dhcp pool LanPool-3
network 172.16.255.64 255.255.255.224
default-router 172.16.255.65
```

验证PC0通过DHCP协议获取ip地址如下

![实验楼dhcp](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202304271543413.png)
