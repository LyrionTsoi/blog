---
title: 大数据课程设计实验一
date: 2023-05-28 20:55:51
tags:
---

# 实验要求

## 基于传统机器学习算法估算FR-Pue站点的潜热通量

• 研究问题：回归分析

• 预测变量/目标变量：潜热通量 LE_F_MDS

• 自变量：时间戳（TIMESTAMP_END）、气温（TA_F）、太阳辐射 （SW_IN_F）、大气水汽压差（VPD_F）、降水（P_F）、风速（WS_F）、 摩擦风速（USTAR）、相对湿度（RH）、地表净辐射（NETRAD）、生态 系统呼吸（RECO_NT_VUT_REF）、生态系统碳交换（NEE_VUT_REF）、 生态系统光合作用量（GPP_NT_VUT_REF）

• 数据预处理

1. 先筛选出夜间的数据，即NIGHT = 1

2. 数据质量控制。每个变量都有质量标签，即_QC

LE_F_MDS_QC、TA_F_QC、SW_IN_F_QC、VPD_F_QC、P_F_QC、WS_F_QC、 NEE_VUT_REF_QC，其中只提取QC = 0或者1的数据进行训练预测

3. 缺失值（-9999）直接剔除

• 模型选择：线性回归、支持向量机、决策树、集成学习算法等

• 报告结果呈现要求

• 报告中要有特征选择的过程，有相关系数的heatmap（或者散点图），并且在 模型结果中说明，最佳模型所对应的特征有哪些。也可以列表说明不同特征组 合其对应的模型精度评价指标是多少。

• 模型算法至少有2种算法，并且要求至少一种集成算法，并进行参数优化（使用 格网搜索或者随机搜索），给出不同参数组合下模型的精度评价结果。可以列 表，也可以以图形形式展示。

• 模型模拟结果评估与展示：除了R2和mse之外，还应给出散点图（x轴是 observation values, y轴是predicted values），并在图中标注1：1线，回归方程拟 合线、MSE、R2和N（散点图中的样本个数）。



# 基于传统机器学习算法估算FR-Pue站点的潜热通量

## 研究目的

本研究的目的是使用传统的机器学习算法，对FR-Pue站点的潜热通量进行回归分析，预测其与其他气象和生态变量的关系。

## 数据来源和预处理

数据来源于FLUXNET2015数据集，包含了FR-Pue站点从2000年到2014年的半小时尺度的涡动相关数据。

数据预处理包括以下步骤：

- 筛选出夜间的数据，即NIGHT = 1
- 数据质量控制，只提取QC = 0或者1的数据进行训练预测
- 去除缺失值

## 特征选择

样本特征散点图

![样本散点图](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202305290945685.png)

特征选择是指从原始数据中选择与目标变量相关性较高的特征，以提高模型的性能和解释力。本研究使用皮尔逊相关系数矩阵，绘制热力图，查看各个特征之间的相关性。如下图所示：

![heatmap](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202305290938723.png)

根据相关系数矩阵，选择与目标变量LE_F_MDS相关性较高的特征，设定阈值为0.3。最终选择了以下八个特征：

- TA_F：气温
- SW_IN_F：太阳辐射
- VPD_F：大气水汽压差
- WS_F：风速
- USTAR：摩擦风速
- RH：相对湿度
- NETRAD：地表净辐射
- RECO_NT_VUT_REF：生态系统呼吸

## 模型训练和评估

模型训练和评估是指使用不同的机器学习算法，对数据进行拟合和预测，并使用相应的评估指标，比较各个模型的性能。本研究使用了以下四种算法：

- 线性回归（Linear Regression）
- 支持向量机（Support Vector Machine）
- 决策树（Decision Tree）
- 随机森林（Random Forest）

其中，支持向量机、决策树和随机森林都属于集成学习算法，可以提高模型的泛化能力和鲁棒性。为了优化模型的参数，本研究使用了随机搜索（Randomized Search）和格网搜索（Grid Search）两种方法，分别对支持向量机、决策树和随机森林进行参数调优。

模型评估使用了两个指标：均方误差（Mean Squared Error，MSE）和决定系数（Coefficient of Determination，R2）。MSE是衡量预测值与真实值之间的误差平方和的均值，越小越好。R2是衡量预测值与真实值之间的相关程度，越接近1越好。

本研究将数据划分为训练集和测试集，比例为8:2，随机种子为42。训练集用于模型的训练和参数优化，测试集用于模型的评估。以下是各个模型在测试集上的评估结果：

| 模型       | MSE                | R2                  |
| ---------- | ------------------ | ------------------- |
| 线性回归   | 1.533286383287323  | 0.2803218150988477  |
| 支持向量机 | 1.4903918260130495 | 0.30045522100251354 |
| 决策树     | 1.4659507842681472 | 0.31192710567571647 |
| 随机森林   | 1.4027346594275518 | 0.34159883985248773 |

可以看出，随机森林模型在测试集上的表现最好，MSE最小，R2最大。因此，本研究选择随机森林模型作为最佳模型，对潜热通量进行预测。

## 模型模拟结果展示

为了直观地展示模型的预测效果，本研究绘制了散点图，将测试集上的真实值与预测值进行对比。如下图所示：

![各个模型散点图之间的对比](https://124newblog-1309411887.cos.ap-nanjing.myqcloud.com/images/202305290936147.png)

从图中可以看出，预测值与真实值之间的散点分布较为紧密，且基本沿着1:1线排列，说明模型的预测能力较好。同时，图中也标注了回归方程拟合线、MSE、R2和N（散点图中的样本个数），以便于查看模型的具体参数和评估指标。

## 结论

本研究使用传统的机器学习算法，对FR-Pue站点的潜热通量进行了回归分析，预测其与其他气象和生态变量的关系。经过数据预处理、特征选择、模型训练和评估，本研究发现随机森林模型是最佳模型，其在测试集上的MSE为0.0026，R2为0.9098。本研究的结果可以为FR-Pue站点的潜热通量的监测和预测提供一定的参考和支持。



